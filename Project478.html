<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head></head><body>


	
	
	
	
	
	

<pre># -*- coding: utf-8 -*-
&quot;&quot;&quot;Untitled0.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1NTTC-JSfCzF4YUcSKMZeSaJJkfim5qeE
&quot;&quot;&quot;

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

import pandas as pd
data = pd.read_csv(&quot;https://github.com/dobariadhruv/Black-Friday-Sales-Prediction/files/9996111/BlackFridaySales.csv&quot;)

data.shape

data.head()

data.describe()

data.info()

&quot;&quot;&quot;**Checking Null Value**&quot;&quot;&quot;

data.isnull().sum()

&quot;&quot;&quot;**Checking percentage of Null Value**&quot;&quot;&quot;

data.isnull().sum()/data.shape[0]*100

&quot;&quot;&quot;There are 31% null values in the Product_Category_2 and 69% null values in the Product_Category_3

**Checking Unique Value in dataset**
&quot;&quot;&quot;

data.nunique()

&quot;&quot;&quot;**Exploratory Data Analysis**

Target Variable- Purchase
&quot;&quot;&quot;

boxplot =data.boxplot(column=[&quot;Purchase&quot;,], return_type=&#39;axes&#39;)

&quot;&quot;&quot;Purchase value have some outliers and is positive skewed


&quot;&quot;&quot;

data[&quot;Purchase&quot;].skew()

data[&quot;Purchase&quot;].kurtosis()

sns.distplot(data[&quot;Purchase&quot;],color=&#39;b&#39;)
plt.title(&quot;Purchase Distribution&quot;)
plt.show()

&quot;&quot;&quot;**Age**&quot;&quot;&quot;

sns.countplot(data[&#39;Age&#39;])
plt.title(&#39;Distribution of Age&#39;)
plt.xlabel(&#39;Different Categories of Age&#39;)
plt.show()

&quot;&quot;&quot;Age group 26-35 makes the most number of purchases.&quot;&quot;&quot;

data.groupby(&quot;Age&quot;).mean()[&quot;Purchase&quot;].plot(kind=&#39;bar&#39;)

data.groupby(&quot;Age&quot;).sum()[&#39;Purchase&#39;].plot(kind=&quot;bar&quot;)
plt.title(&quot;Age and Purchase Analysis&quot;)
plt.show()

&quot;&quot;&quot;Total amount spent in purchase with respect to age attribute

**Gender**
&quot;&quot;&quot;

sns.countplot(data[&#39;Gender&#39;])
plt.show()

data[&#39;Gender&#39;].value_counts(normalize=True)*100

data.groupby(&quot;Gender&quot;).mean()[&quot;Purchase&quot;]

&quot;&quot;&quot;On average, males spend more money on purchases than females.

**Martial Status**
&quot;&quot;&quot;

sns.countplot(data[&#39;Marital_Status&#39;])
plt.show()

data.groupby(&quot;Marital_Status&quot;).mean()[&quot;Purchase&quot;].plot(kind=&#39;bar&#39;)
plt.title(&quot;Marital_Status and Purchase Analysis&quot;)
plt.show()

&quot;&quot;&quot;Although unmarried people spend more money on purchases, the average purchase amount for married and unmarried people is the same.

**City_Category**
&quot;&quot;&quot;

sns.countplot(data[&#39;City_Category&#39;])
plt.show()

&quot;&quot;&quot;It is observed that city category B has made the most number of puchases.

**Product_Category_1**
&quot;&quot;&quot;

plt.hist(data[&quot;Product_Category_1&quot;]) 
plt.xlabel(&#39;Product_Category_1&#39;)
plt.ylabel(&#39;Count&#39;)
plt.title(&#39;Histogram of Product_Category_1&#39;)
plt.grid(True)

&quot;&quot;&quot;Product_Category1 is right skewed&quot;&quot;&quot;

data.groupby(&#39;Product_Category_1&#39;).sum()[&#39;Purchase&#39;].plot(kind=&#39;bar&#39;,figsize=(18,5))
plt.title(&quot;Product_Category_1 and Purchase Analysis&quot;)
plt.show()

&quot;&quot;&quot;**Product_category_2**&quot;&quot;&quot;

plt.hist(data[&quot;Product_Category_2&quot;]) 
plt.xlabel(&#39;Product_Category_2&#39;)
plt.ylabel(&#39;Count&#39;)
plt.title(&#39;Histogram of Product_Category_2&#39;)
plt.grid(True)

&quot;&quot;&quot;Product_category_3&quot;&quot;&quot;

plt.hist(data[&quot;Product_Category_3&quot;]) 
plt.xlabel(&#39;Product_Category_3&#39;)
plt.ylabel(&#39;Count&#39;)
plt.title(&#39;Histogram of Product_Category_3&#39;)
plt.grid(True)

&quot;&quot;&quot;**Stay_In_Current_City_Years**&quot;&quot;&quot;

sns.countplot(data[&#39;Stay_In_Current_City_Years&#39;])
plt.show()

&quot;&quot;&quot;It appears that the longer someone lives in that city, the less likely they are to purchase new items. As a result, if someone is new in town and needs a lot of new things for their house, they will take advantage of the low prices on Black Friday to get everything they need.

**Correlation** **between** **varibles**
&quot;&quot;&quot;

data.corr()

sns.heatmap(data.corr(),annot=True)
plt.show()

&quot;&quot;&quot;There is a some corellation between the product category groups.

**Creating Dummy variable**
&quot;&quot;&quot;

data.columns

df = data.copy()

df = pd.get_dummies(df, columns=[&#39;Stay_In_Current_City_Years&#39;])

df.head(10)

&quot;&quot;&quot;**Dropping the irrelevant** **columns**&quot;&quot;&quot;

df = df.drop([&quot;User_ID&quot;,&quot;Product_ID&quot;],axis=1)

&quot;&quot;&quot;**Encoding Categorical variable**&quot;&quot;&quot;

from sklearn.preprocessing import LabelEncoder
lr = LabelEncoder()
df[&#39;Gender&#39;] = lr.fit_transform(df[&#39;Gender&#39;])
df[&#39;Age&#39;] = lr.fit_transform(df[&#39;Age&#39;])
df[&#39;City_Category&#39;] = lr.fit_transform(df[&#39;City_Category&#39;])

df.head(5)

&quot;&quot;&quot;**Handling missing value and replacing it with mean**&quot;&quot;&quot;

mean1 = df.Product_Category_2.mean()
mean2 = df.Product_Category_3.mean()
df[&#39;Product_Category_2&#39;] =df[&#39;Product_Category_2&#39;].fillna(mean1).astype(&#39;int64&#39;)
df[&#39;Product_Category_3&#39;] =df[&#39;Product_Category_3&#39;].fillna(mean2).astype(&#39;int64&#39;)

df.isnull().sum()

df.info()

&quot;&quot;&quot;**Splitting data into training and testing sets**&quot;&quot;&quot;

X = df.drop(&quot;Purchase&quot;,axis=1)
y=df[&#39;Purchase&#39;]

from sklearn.model_selection import train_test_split
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=123)

&quot;&quot;&quot;**Linear regression**&quot;&quot;&quot;

from sklearn.linear_model import LinearRegression

# Create linear regression object
lr = LinearRegression()

# Train the model using the training set
lr.fit(X_train,y_train)

lr.intercept_

lr.coef_

y_pred = lr.predict(X_test)

from sklearn.metrics import mean_absolute_error,mean_squared_error, r2_score

mean_absolute_error(y_test, y_pred)

mean_squared_error(y_test, y_pred)

print(&quot;Accuracy of the LinearRegression model comes to be: \n &quot;)
r2_score(y_test, y_pred)

rmse_train = np.sqrt(mean_squared_error(y_test, y_pred))
print(&quot;RMSE on Test Data: &quot;, rmse_train)

&quot;&quot;&quot;**Lasso Regression**&quot;&quot;&quot;

from sklearn.linear_model import Lasso
reg2 = Lasso()

reg2.fit(X_train,y_train)

pred2 = reg2.predict(X_test)

pred2

print(&quot;Accuracy of the LassoRegression model comes to be: \n &quot;) 
print(reg2.score(X_train,y_train))

rmse_train = np.sqrt(mean_squared_error(y_test, pred2))
print(&quot;RMSE on Test Data: &quot;, rmse_train)



&quot;&quot;&quot;**Ridge Regression**&quot;&quot;&quot;

# Importing model
from sklearn.linear_model import Ridge
reg3 = Ridge()

reg3.fit(X_train, y_train)

pred3= reg3.predict(X_test)

print(&quot;Accuracy of the RidgeRegression model comes to be: \n &quot;) 
print(reg3.score(X_train,y_train))



rmse_train = np.sqrt(mean_squared_error(y_test, pred3))
print(&quot;RMSE on Test Data: &quot;, rmse_train)



&quot;&quot;&quot;**Decision Tree Regressor**&quot;&quot;&quot;

from sklearn.tree import DecisionTreeRegressor

# create a regressor object 
regressor = DecisionTreeRegressor(random_state = 0)

regressor.fit(X_train, y_train)

dt_y_pred = regressor.predict(X_test)

mean_absolute_error(y_test, dt_y_pred)

mean_squared_error(y_test, dt_y_pred)

r2_score(y_test, dt_y_pred)

print(&quot;Accuracy of the Decesion tree regressor model comes to be: \n &quot;) 
print(r2_score(y_test, dt_y_pred))

from math import sqrt
print(&quot;RMSE of Decision tree regressor Model is &quot;,sqrt(mean_squared_error(y_test, dt_y_pred)))

&quot;&quot;&quot;***Random Forest regressor***&quot;&quot;&quot;

from sklearn.ensemble import RandomForestRegressor

# create a regressor object 
RFregressor = RandomForestRegressor(random_state = 0)

RFregressor.fit(X_train, y_train)

rf_y_pred = RFregressor.predict(X_test)

mean_absolute_error(y_test, rf_y_pred)

mean_squared_error(y_test, rf_y_pred)

r2_score(y_test, rf_y_pred)

print(&quot;Accuracy of the Random Forest regressor model comes to be: \n &quot;) 
print(r2_score(y_test, rf_y_pred))

from math import sqrt
print(&quot;RMSE of Random forest regresion Model is &quot;,sqrt(mean_squared_error(y_test, rf_y_pred)))

&quot;&quot;&quot;**XGBoost Regressor**&quot;&quot;&quot;

from xgboost.sklearn import XGBRegressor
xgb_reg = XGBRegressor(learning_rate=1.0, max_depth=6, min_child_weight=40, seed=0)

xgb_reg.fit(X_train, y_train)

xgb_y_pred = xgb_reg.predict(X_test)

mean_absolute_error(y_test, xgb_y_pred)

mean_squared_error(y_test, xgb_y_pred)

r2_score(y_test, xgb_y_pred)

print(&quot;Accuracy of the XGBoost regressor model comes to be: \n &quot;) 
print(r2_score(y_test, xgb_y_pred))

from math import sqrt
print(&quot;RMSE of XGBoost Regression Model is &quot;,sqrt(mean_squared_error(y_test, xgb_y_pred)))</pre>

<script type="module" src="https://s.brightspace.com/lib/bsi/20.23.8-201/unbundled/mathjax.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					if (document.querySelector('math') || /\$\$|\\\(|\\\[|\\begin{|\\ref{|\\eqref{/.test(document.body.innerHTML)) {
						document.querySelectorAll('mspace[linebreak="newline"]').forEach(elm => {
							elm.setAttribute('style', 'display: block; height: 0.5rem;');
						});

						window.D2L.MathJax.loadMathJax({
							'outputScale': 1.5,
							'renderLatex': false
						});
					}
				});</script><script type="module" src="https://s.brightspace.com/lib/bsi/20.23.8-201/unbundled/prism.js"></script><script type="text/javascript">document.addEventListener('DOMContentLoaded', function() {
					document.querySelectorAll('.d2l-code').forEach(code => {
						window.D2L.Prism.formatCodeElement(code);
					});
				});</script></body></html>